spring:
  threads:
    virtual:
      enabled: true
  mvc:
    static-path-pattern: /static/**
  servlet:
    multipart:
      enabled: true
      max-file-size: 100MB
      max-request-size: 100MB
      file-size-threshold: 10MB
      location: ${UPLOAD_TEMP_DIR:/tmp}
      resolve-lazily: false
    encoding:
      charset: utf-8
      enabled: true
      force-response: true
      force: true
  config:
    import:
      - optional:consul:${app.cloud.host}:${app.cloud.port}
      - optional:classpath:application-data.yaml
      - optional:classpath:application-cache.yaml
      - optional:classpath:application-mongo.yaml
      - optional:classpath:application-search.yaml
      - optional:classpath:application-ai.yaml
      - optional:classpath:application-schedule.yaml
      - optional:classpath:application-security.yaml
      - optional:classpath:application-excel.yaml
      - optional:classpath:application-storage.yaml
      - optional:classpath:application-local-task-message.yaml
  cloud:
    consul:
      host: ${app.cloud.host}
      port: ${app.cloud.port}
      discovery:
        service-name: ${spring.application.name}
        health-check-interval: 15s
        health-check-timeout: 5s
        health-check-path: /actuator/health
        prefer-ip-address: true
        instance-id: ${spring.application.name}-${random.uuid}
      config:
        enabled: true
        format: YAML
        default-context: ${spring.application.name}
        data-key: data
        watch:
          enabled: true
          delay: 1000
        prefixes:
          - config
  web:
    resources:
      add-mappings: false
    error:
      include-message: never
      include-stacktrace: never
      include-exception: false
      whitelabel:
        enabled: false
server:
  tomcat:
    max-connections: 8192
    accept-count: 200
    max-http-form-post-size: 20MB
    max-swallow-size: 20MB
  http2:
    enabled: true
  compression:
    enabled: true
    mime-types:
      - application/json
      - text/html
      - text/css
      - application/javascript
      - image/svg+xml
    min-response-size: 1KB

dubbo:
  consumer:
    lazy: false
    timeout: 5000
    check: false
    retries: 0
  application:
    name: dubbo-${spring.application.name}
    qos-enable: false
    qos-accept-foreign-ip: false
  protocol:
    name: dubbo
    port: -1
    threadpool: virtual
    accepts: 1000
    payload: 8388608
    buffer: 8192
    heartbeat: 60000
    queues: 200
  registry:
    address: consul://${app.cloud.host}:${app.cloud.port}
  scan:
    base-packages: ${app.dubbo.scan-packages}

logging:
  config: classpath:logback-spring.xml
  file:
    path: log
    name: ${spring.application.name}
  level:
    root: INFO

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
        exclude: shutdown
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      show-components: always
      probes:
        enabled: true
  metrics:
    tags:
      application: ${spring.application.name}

app:
  snow-flake:
    data-center-id: 0
  dubbo:
    scan-packages: /
  cloud:
    host: localhost
    port: 8500
  cors:
    allowed-methods:
      - GET
      - POST
      - PUT
      - DELETE
      - PATCH
      - OPTIONS
    max-age: 3600
    allow-credentials: true
